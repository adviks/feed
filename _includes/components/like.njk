<button class="like-button" data-post-id="{{ post.id }}">
  ❤️ Like (<span class="like-count">0</span>)
</button>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const scriptURL = "https://script.google.com/macros/s/AKfycbwnrUs6swj0tLvgbGgaJJcZ35tMqo7bVlxCaOY8dfEz9OkL9HqO4SNwKpTPyT82dDvwUg/exec"; // Change this once

    document.querySelectorAll(".like-button").forEach((button) => {
      const postId = button.getAttribute("data-post-id");
      const countSpan = button.querySelector(".like-count");

      // Fetch existing likes
      fetch(`${scriptURL}?postID=${postId}`)
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            countSpan.textContent = data.likes;
          }
        });

      // Handle like button click
      button.addEventListener("click", function () {
        fetch(scriptURL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ postID: postId })
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            countSpan.textContent = data.likes;
          }
        });
      });
    });
  });
</script>
